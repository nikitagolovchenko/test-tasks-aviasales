(this["webpackJsonptest-tasks-aviasales"]=this["webpackJsonptest-tasks-aviasales"]||[]).push([[0],{65:function(t,e,n){"use strict";n.r(e);var a,c,r,s=n(0),i=n.n(s),o=n(14),l=n.n(o),u=n(13),d=n(94),j=n(91),b=n(97),T=n(92),p=n(93),O=n(68),m=n(66),g=n(28),f=n(83),h=n(95),x=n(27),E=n.n(x),v=n(38);!function(t){t.TICKET_LOADING="TICKET_LOADING",t.TICKET_SUCCESS="TICKET_SUCCESS",t.TICKET_SORTING="TICKET_SORTING",t.TICKET_FILTERING="TICKET_FILTERING",t.GET_MORE_TICKET="GET_MORE_TICKET"}(a||(a={})),function(t){t.CHEAP="CHEAP",t.FAST="FAST",t.OPTIMAL="OPTIMAL"}(c||(c={})),function(t){t.ALL="ALL",t.WITHOUT_TRANSFERS="WITHOUT_TRANSFERS",t.ONE_TRANSFERS="ONE_TRANSFERS",t.TWO_TRANSFERS="TWO_TRANSFERS",t.THREE_TRANSFERS="THREE_TRANSFERS"}(r||(r={}));var I=function(){return{type:a.TICKET_LOADING}},S=n(4),R=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.ticket})),n=e.loading,c=e.filterBtns,s=function(e){var n;t((n=e.target.name,function(t,e){var c=e().ticket.tickets,s=[];switch(n){case r.ALL:s=c;break;case r.WITHOUT_TRANSFERS:s=c.filter((function(t){return t.segments[0].stops.length<1||t.segments[1].stops.length<1}));break;case r.ONE_TRANSFERS:s=c.filter((function(t){return 1===t.segments[0].stops.length||1===t.segments[1].stops.length}));break;case r.TWO_TRANSFERS:s=c.filter((function(t){return t.segments[0].stops.length<3&&t.segments[0].stops.length>1||t.segments[1].stops.length<3&&t.segments[0].stops.length>1}));break;case r.THREE_TRANSFERS:s=c.filter((function(t){return t.segments[0].stops.length>2||t.segments[1].stops.length>2}));break;default:s=c}t({type:a.TICKET_FILTERING,payload:{filter:n,tickets:s}}),t({type:a.TICKET_SORTING,payload:e().ticket.sortBtns.activeBtn})}))};return Object(S.jsx)(m.a,{children:Object(S.jsxs)(d.a,{p:2,children:[Object(S.jsx)(g.a,{variant:"button",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),c.btns.map((function(t,e){return Object(S.jsx)(d.a,{children:Object(S.jsx)(f.a,{control:Object(S.jsx)(h.a,{disabled:n,checked:t.name===c.activeBtn,onChange:s,name:t.name,color:"primary"}),label:t.text})},e)}))]})})},y=n(21),k=n(84),C=n(85),_=Object(k.a)((function(t){var e;return{root:(e={width:"100%",marginBottom:t.spacing(3),flexDirection:"column"},Object(y.a)(e,t.breakpoints.up("sm"),{flexDirection:"row"}),Object(y.a)(e,t.breakpoints.down("xs"),{"& $btn":{borderRadius:t.shape.borderRadius,borderColor:t.palette.primary.light,marginBottom:t.spacing(1),"&:last-child":{marginBottom:0}}}),Object(y.a)(e,"& > *",{flexGrow:1}),e),btn:{}}})),N=function(){var t=_(),e=Object(u.b)(),n=Object(u.c)((function(t){return t.ticket})),c=n.sortBtns,r=c.btns,s=c.activeBtn,i=n.loading,o=function(t){e(function(t){return{type:a.TICKET_SORTING,payload:t}}(t))};return Object(S.jsx)(C.a,{color:"primary",className:t.root,size:"large",disabled:i,children:r.map((function(e){return Object(S.jsx)(O.a,{name:e.name,variant:e.name===s?"contained":"outlined",onClick:function(){return o(e.name)},className:t.btn,children:e.text},e.name)}))})},A=n(86),B=n(87),F=n(88),L=n(89),K=n(96),w=n(90),G=function(t){var e=new Date(t),n=e.getFullYear(),a=e.getMonth()<10?"0".concat(e.getMonth()):e.getMonth(),c=e.getDate()<10?"0".concat(e.getDate()):e.getDate(),r=e.getHours()<10?"0".concat(e.getHours()):e.getHours(),s=e.getMinutes()<10?"0".concat(e.getMinutes()):e.getMinutes();return"".concat(c,".").concat(a,".").concat(n," - ").concat(r,":").concat(s)},M=function(t){var e=Math.floor(t/60);e=e<10?"0".concat(e):e;var n=Math.floor(100*(t/60-Number(e)));return n=n<10?"0".concat(n):n,"".concat(e,"\u0447 ").concat(n,"\u043c")},H=function(t){switch(t){case 1:return"".concat(t," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430");case 2:case 3:case 4:return"".concat(t," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438");default:return"".concat(t," \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a")}},D=function(t){if(t>1e3){var e=Math.floor(t/1e3),n=t-1e3*e;return"".concat(e," ").concat(n<10?"00"+n:n<100?"0"+n:n)}return"".concat(t)},P=Object(k.a)((function(t){return{list:{display:"flex",flexWrap:"wrap",paddingBottom:"0","&:last-child":{paddingTop:"0",paddingBottom:t.spacing(1)}},listItem:{paddingLeft:"0",paddingRight:"0",flex:"1 1 33.33333%"},listItemText:{display:"flex",flexDirection:"column-reverse"},secondaryText:{textTransform:"uppercase"}}})),W=function(t){var e=t.ticket,n=P();return Object(S.jsx)(d.a,{mb:2,children:Object(S.jsx)(A.a,{children:Object(S.jsx)(B.a,{children:Object(S.jsxs)(F.a,{children:[Object(S.jsxs)(d.a,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:0,children:[Object(S.jsxs)(g.a,{variant:"h5",color:"primary",children:[D(e.price)," ","P"]}),Object(S.jsx)("img",{src:"".concat("https://pics.avs.io/99/36/").concat(e.carrier,".png"),alt:e.carrier})]}),Object(S.jsx)(d.a,{children:e.segments.map((function(t,e){return Object(S.jsxs)(L.a,{className:n.list,children:[Object(S.jsx)(K.a,{className:n.listItem,children:Object(S.jsx)(w.a,{primary:G(t.date),secondary:"".concat(t.origin," - ").concat(t.destination),classes:{root:n.listItemText,secondary:n.secondaryText}})}),Object(S.jsx)(K.a,{className:n.listItem,children:Object(S.jsx)(w.a,{primary:M(t.duration),secondary:"\u0412 \u043f\u0443\u0442\u0438",classes:{root:n.listItemText,secondary:n.secondaryText}})}),Object(S.jsx)(K.a,{className:n.listItem,children:Object(S.jsx)(w.a,{primary:M(t.duration),secondary:H(t.stops.length),classes:{root:n.listItemText,secondary:n.secondaryText}})})]},e)}))})]})})})})},U=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.ticket}));Object(s.useEffect)((function(){t(function(){var t=Object(v.a)(E.a.mark((function t(e,n){var c,r,s,i,o,l;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(I()),t.next=3,fetch("".concat("https://front-test.beta.aviasales.ru/search"));case 3:return c=t.sent,t.next=6,c.json();case 6:return r=t.sent,s=r.searchId,i=!1,o=[],l=function(){var t=Object(v.a)(E.a.mark((function t(){var e,n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i){t.next=18;break}return t.prev=1,t.next=4,fetch("".concat("https://front-test.beta.aviasales.ru/tickets","?searchId=").concat(s));case 4:return e=t.sent,t.next=7,e.json();case 7:n=t.sent,i=n.stop,o=n.tickets,t.next=15;break;case 12:return t.prev=12,t.t0=t.catch(1),t.abrupt("return",l());case 15:return t.abrupt("return",l());case 18:return t.abrupt("return");case 19:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}(),t.next=13,l();case 13:e({type:a.TICKET_SUCCESS,payload:o}),e({type:a.TICKET_SORTING,payload:n().ticket.sortBtns.activeBtn});case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}),[]);return Object(S.jsxs)(d.a,{width:"100%",position:"relative",overflow:"hidden",py:6,children:[Object(S.jsx)(j.a,{}),e.loading&&Object(S.jsx)(d.a,{position:"absolute",top:"0",left:"0",width:"100%",zIndex:"100",children:Object(S.jsx)(b.a,{})}),Object(S.jsxs)(T.a,{maxWidth:"md",children:[Object(S.jsx)(d.a,{mb:3,textAlign:"center",component:"header",children:Object(S.jsx)("img",{src:"./logo.png",alt:"aviasales"})}),Object(S.jsxs)(p.a,{container:!0,spacing:3,children:[Object(S.jsx)(p.a,{item:!0,xs:12,sm:4,children:Object(S.jsx)(R,{})}),Object(S.jsxs)(p.a,{item:!0,xs:12,sm:8,children:[Object(S.jsx)(N,{}),Object(S.jsx)(d.a,{mb:3,children:e.activeTickets.slice(0,e.limit*e.page).map((function(t,e){return Object(S.jsx)(W,{ticket:t},e)}))}),e.total>0&&e.limit*e.page<e.total&&Object(S.jsx)(O.a,{variant:"contained",size:"large",color:"primary",fullWidth:!0,onClick:function(){t({type:a.GET_MORE_TICKET})},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0435 5 \u0431\u0438\u043b\u0435\u0442\u043e\u0432!"})]})]})]})]})},z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,100)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,s=e.getTTFB;n(t),a(t),c(t),r(t),s(t)}))},J=n(15),Y=n(45),$=n(46),q=n(9),Q={tickets:[],activeTickets:[],loading:!1,sortBtns:{btns:[{name:c.CHEAP,text:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439"},{name:c.FAST,text:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"},{name:c.OPTIMAL,text:"\u041e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439"}],activeBtn:c.CHEAP},filterBtns:{btns:[{name:r.ALL,text:"\u0412\u0441\u0435"},{name:r.WITHOUT_TRANSFERS,text:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"},{name:r.ONE_TRANSFERS,text:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430"},{name:r.TWO_TRANSFERS,text:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"},{name:r.THREE_TRANSFERS,text:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"}],activeBtn:r.ALL},limit:5,page:1,total:0},V=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case a.TICKET_LOADING:return Object(q.a)(Object(q.a)({},t),{},{loading:!0});case a.TICKET_SUCCESS:return Object(q.a)(Object(q.a)({},t),{},{loading:!1,tickets:e.payload,activeTickets:e.payload,total:e.payload.length});case a.GET_MORE_TICKET:return Object(q.a)(Object(q.a)({},t),{},{page:t.page+1});case a.TICKET_SORTING:switch(e.payload){case c.CHEAP:return Object(q.a)(Object(q.a)({},t),{},{activeTickets:t.activeTickets.sort((function(t,e){return t.price-e.price})),sortBtns:Object(q.a)(Object(q.a)({},t.sortBtns),{},{activeBtn:e.payload})});case c.FAST:return Object(q.a)(Object(q.a)({},t),{},{activeTickets:t.activeTickets.sort((function(t,e){return t.segments[0].duration+t.segments[1].duration-(e.segments[0].duration+e.segments[1].duration)})),sortBtns:Object(q.a)(Object(q.a)({},t.sortBtns),{},{activeBtn:e.payload})});case c.OPTIMAL:var n=t.activeTickets.reduce((function(t,e){return t.price<e.price?t:e})),r=n.price,s=t.activeTickets.reduce((function(t,e){return t.segments[0].duration+t.segments[1].duration<e.segments[0].duration+e.segments[1].duration?t:e})),i=s.segments[0].duration+s.segments[1].duration;return Object(q.a)(Object(q.a)({},t),{},{activeTickets:t.activeTickets.sort((function(t,e){return(100*t.price/r+100*(t.segments[0].duration+t.segments[1].duration)/i)/2-(100*e.price/r+100*(e.segments[0].duration+e.segments[1].duration)/i)/2})),sortBtns:Object(q.a)(Object(q.a)({},t.sortBtns),{},{activeBtn:e.payload})});default:return Object(q.a)({},t)}case a.TICKET_FILTERING:return Object(q.a)(Object(q.a)({},t),{},{activeTickets:e.payload.tickets,filterBtns:Object(q.a)(Object(q.a)({},t.filterBtns),{},{activeBtn:e.payload.filter}),total:e.payload.tickets.length,page:1});default:return t}},X=Object(J.combineReducers)({ticket:V}),Z=Object(J.createStore)(X,Object(Y.composeWithDevTools)(Object(J.applyMiddleware)($.a)));l.a.render(Object(S.jsx)(i.a.StrictMode,{children:Object(S.jsx)(u.a,{store:Z,children:Object(S.jsx)(U,{})})}),document.getElementById("root")),z()}},[[65,1,2]]]);
//# sourceMappingURL=main.ccf24e06.chunk.js.map